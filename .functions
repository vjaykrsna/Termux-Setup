# ~/.functions
#
# Use this file to store your shell functions.
#

# Source all function libraries
for lib_file in "$HOME/Termux/scripts/library/"*.sh; do
    source "$lib_file"
done

# Create a new directory and enter it
function mkd() {
	mkdir -p "$@" && cd "$_";
}

# Determine size of a file or total size of a directory
function fs() {
	if du -b /dev/null > /dev/null 2>&1; then
		local arg=-sbh;
	else
		local arg=-sh;
	fi
	if [[ -n "$@" ]]; then
		du $arg -- "$@";
	else
		du $arg .[^.]* ./*;
	fi;
}

extract () {
  if [ -f "$1" ]; then
    case "$1" in
      *.tar.bz2) tar xjf "$1" ;;
      *.tar.gz)  tar xzf "$1" ;;
      *.bz2)     bunzip2 "$1" ;;
      *.rar)     unrar x "$1" ;;
      *.gz)      gunzip "$1" ;;
      *.tar)     tar xf "$1" ;;
      *.tbz2)    tar xjf "$1" ;;
      *.tgz)     tar xzf "$1" ;;
      *.zip)     unzip "$1" ;;
      *.Z)       uncompress "$1" ;;
      *.7z)      7z x "$1" ;;
      *)         echo "Don't know how to extract '$1'..." ;;
    esac
  else
    echo "'$1' is not a valid file!"
  fi
}

# Start an HTTP server from a directory, optionally specifying the port
function server() {
	local port="${1:-8000}";
	sleep 1 && open "http://localhost:${port}/" &
  python -m http.server "$port"
}

# See if my connection works - or invoke ping
function p() {
  if [ -z $1 ]
    then ping 1.1.1.1
    else ping "$@"
   fi
}

# Print each PATH entry on a separate line
path() {
    echo -e ${PATH//:/\\n}
}


# Change terminal color scheme
chcolor() {
    if [ ! -d "$HOME/.termux/colors" ]; then
        echo "Themes directory not found: $HOME/.termux/colors"
        return 1
    fi

    local theme=$(ls "$HOME/.termux/colors" | fzf --prompt="Select a theme: ")
    if [ -n "$theme" ]; then
        ln -sf "$HOME/.termux/colors/$theme" "$HOME/.termux/colors.properties"
        termux-reload-settings
        echo "Theme changed to $theme"
    fi
}


# Change terminal font
chfont() {
    if [ ! -d "$HOME/.termux/fonts" ]; then
        echo "Fonts directory not found: $HOME/.termux/fonts"
        return 1
    fi

    local font=$(ls "$HOME/.termux/fonts" | fzf --prompt="Select a font: ")
    if [ -n "$font" ]; then
        ln -sf "$HOME/.termux/fonts/$font" "$HOME/.termux/font.ttf"
        termux-reload-settings
        echo "Font changed to $font"
    fi
}


# Change Zsh theme
chzsh() {
    if [ ! -d "$HOME/.oh-my-zsh/themes" ]; then
        echo "Zsh themes directory not found: $HOME/.oh-my-zsh/themes"
        return 1
    fi

    local theme=$(ls "$HOME/.oh-my-zsh/themes" | fzf --prompt="Select a Zsh theme: ")
    if [ -n "$theme" ]; then
        sed -i "s/^ZSH_THEME=.*/ZSH_THEME=\"$theme\"/" "$HOME/.zshrc"
        echo "Zsh theme changed to $theme. Please restart your terminal."
    fi
}
